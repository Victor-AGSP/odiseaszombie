/* Card component styles: compact, tactile, isolated from global menu styles */
.card-root {
  /* slightly larger canonical card size so artwork reads clearly */
  width: 120px;
  height: 176px;
  display: flex;
  align-items: center;
  justify-content: center;
  box-sizing: border-box;
  cursor: pointer;
  user-select: none;
  position: relative;
  transform-style: preserve-3d;
}

/* Personaje: landscape (horizontal) card shape but keep content stacked vertically
   so numbers/readout remain in a vertical layout. We change the root size and
   tweak inner padding & typography to fit the landscape form. */
.card-root.personaje {
  width: 176px;
  height: 120px;
}
.card-root.personaje .card-inner {
  padding: 0;
  transform: rotateX(14deg) translateZ(-2px);
}
.card-root.personaje .card-badge { left: 8px; top: 6px; width: 20px; height: 20px; font-size:0.85rem }
.card-root.personaje .card-conflict { right: 8px; top: 6px; width: 28px; height: 22px }
.card-root.personaje .card-risk { font-size: 2.2rem; margin-top: 8px }

.card-root:focus{outline:none}

/* inner element that will rotate/tilt in 3D */
.card-inner{
  position:relative;
  width:100%;
  height:100%;
  transform-style:preserve-3d;
  /* single canonical transition for card inner (kept concise and snappy) */
  transition: transform 360ms cubic-bezier(.22,.9,.3,1), box-shadow 180ms ease;
  /* baseline perspective tilt: top appears further (smaller) than bottom */
  transform-origin: center top;
  transform: rotateX(22deg) translateZ(-2px); /* stronger tilt for more pronounced perspective */
  /* visual styling moved here so border/shadow follow the 3D transform */
  background: linear-gradient(180deg, #0f1315 0%, #061013 100%);
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.06);
  box-shadow: 0 8px 30px rgba(2,6,23,0.65), inset 0 -4px 12px rgba(0,0,0,0.45);
  color: #e6eef6;
  display:flex;
  flex-direction: column;
  align-items: center;
  padding: 0;
  box-sizing: border-box;
  backface-visibility: hidden;
  will-change: transform;
}

/* Type-specific accents (talento, evento, iniciativa) */
.card-root.talento .card-inner { background: linear-gradient(180deg, #102226 0%, #061a18 100%); }
.card-root.evento .card-inner { background: linear-gradient(180deg, #220f18 0%, #12070a 100%); }
.card-root.iniciativa .card-inner { background: linear-gradient(180deg, #1b1422 0%, #0d0710 100%); border: 1px solid rgba(200,170,100,0.06) }

/* pseudo-element used for outlines (so they transform with the card) */
.card-inner::after{
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  border-radius: inherit;
  box-sizing: border-box;
  border: 1px solid transparent;
  /* slightly larger Z offset so the outline stays visually above the surface */
  transform: translateZ(3px);
}

/* Unified border for cards on the mesa (table) - single source of truth */
.table-cards .card-root .card-inner::after,
.table-slot .card-root .card-inner::after {
  border: 1px solid rgba(255,255,255,0.04);
  box-shadow: 0 0 0 3px rgba(0,0,0,0.06) inset;
}

.card-face{position:absolute;inset:0;display:flex;flex-direction:column;align-items:center;padding:0;box-sizing:border-box;border-radius:10px;backface-visibility:hidden}
.card-front{z-index:2}
.card-back{transform:rotateY(180deg);background:linear-gradient(180deg,#081017,#05100d);display:flex;align-items:center;justify-content:center}
.card-back-art{font-size:2rem;opacity:0.9}

/* Note: hover/pop straightening intentionally removed to keep cards' baseline perspective.
   Click animations are handled in JS for a custom disappear/reappear effect. */

/* Canonical table-card style: single source of truth for cards displayed on the mesa.
   This prevents multiple conflicting rules from making errant (4-roll) cards look different. */
.table-cards .card-root .card-inner,
.table-slot .card-root .card-inner {
  transform: rotateX(22deg) translateZ(-2px);
  /* unified shadow + subtle red glow for mesa */
  box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 -4px 12px rgba(0,0,0,0.45), 0 0 18px rgba(138,7,7,0.06);
}

/* Smooth return to default tilt when mouse leaves - handled by .card-inner transition above */

/* When a card is the source of a preview animation, keep it visually popped for the duration
   so it doesn't snap back while a clone flies to the modal. The class is added/removed via JS. */
.preview-source .card-inner {
  transform: rotateX(0deg) rotateY(0deg) translateZ(28px) translateY(-2px) !important;
  box-shadow: 0 40px 88px rgba(2,6,23,0.88) !important;
  transition: transform 520ms cubic-bezier(.2,.9,.28,1), box-shadow 320ms ease !important;
}

.card-badge {
  position: absolute;
  left: 6px;
  top: 6px;
  width: 20px;
  height: 20px;
  border-radius: 6px;
  background: rgba(255,255,255,0.04);
  display:flex; align-items:center; justify-content:center; font-weight:700; font-size:0.85rem;
}

.card-risk {
  font-size: 2.4rem;
  font-weight: 800;
  margin-top: 14px;
  color: #ffe9b3;
  text-shadow: 0 2px 6px rgba(0,0,0,0.6);
}

.card-conflict {
  position: absolute;
  right: 6px;
  top: 6px;
  width: 28px;
  height: 24px;
  border-radius: 6px;
  background: rgba(255,80,80,0.06);
  display:flex; align-items:center; justify-content:center; font-weight:800; color:#ffb0b0;
}

.card-art {
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 8px;
  box-sizing: border-box;
  font-size: 1rem;
  color: #e6eef6;
  text-align: center;
  background: linear-gradient(180deg,#0f1315,#061013);
  z-index: 1;
}

.card-face.card-front { position: absolute; inset: 0; overflow: hidden }
.card-art-img {
  position: absolute;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: block;
  z-index: 1;
}
/* Ensure overlay elements are above the artwork */
.card-badge, .card-risk, .card-conflict { position: relative; z-index: 2 }

/* Hide numeric overlays and type badge visually while keeping them in the DOM
  (they remain available in code for logic but are not visible to the player) */
.card-badge, .card-risk, .card-conflict { display: none !important }

.card-root.allied .card-inner::after{ border-color: rgba(120,200,180,0.16); box-shadow: 0 0 0 3px rgba(120,200,180,0.03) inset }

/* Normalize errant global shadow to match base so it doesn't make borders darker by default */
.card-root.errant .card-inner{ box-shadow: 0 8px 30px rgba(2,6,23,0.65), inset 0 -4px 12px rgba(0,0,0,0.45) }

/* Ensure errant cards placed on the mesa use the unified mesa style (no extra heavy shadow) */
.table-cards .card-root.errant .card-inner,
.table-slot .card-root.errant .card-inner {
  box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 -4px 12px rgba(0,0,0,0.45), 0 0 18px rgba(138,7,7,0.06);
}

/* Optional gentle pulse to emulate the small light behind the card when a 4 is rolled */
.table-cards .card-root.pulse .card-inner,
.table-slot .card-root.pulse .card-inner {
  animation: mesa-pulse 1600ms ease-in-out infinite;
}

@keyframes mesa-pulse {
  0% { box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 -4px 12px rgba(0,0,0,0.45), 0 0 10px rgba(138,7,7,0.04); }
  50% { box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 -4px 12px rgba(0,0,0,0.45), 0 0 18px rgba(138,7,7,0.09); }
  100% { box-shadow: 0 10px 30px rgba(2,6,23,0.6), inset 0 -4px 12px rgba(0,0,0,0.45), 0 0 10px rgba(138,7,7,0.04); }
}

/* Responsive adjustments grouped and ordered from large -> small */
@media (max-width: 920px) {
  /* slightly reduce tilt on medium screens */
  .card-inner { transform: rotateX(16deg) translateZ(-1px) }
}

@media (max-width: 720px) {
  /* further reduce tilt and slightly smaller card size */
  .card-inner { transform: rotateX(10deg) }
  .card-root { width: 84px; height: 120px }
  .card-risk { font-size: 2rem }
  /* ensure personaje stays landscape but scales down on medium screens */
  .card-root.personaje { width: 120px; height: 84px }
}

@media (max-width: 420px) {
  /* compact phone sizes */
  .card-inner { transform: rotateX(6deg) }
  .card-root { width: 72px; height: 104px }
  .card-risk { font-size: 1.4rem }
  .card-conflict { font-size: 0.82rem }
  .card-art { font-size: 1rem }
  /* small phones: shrink personaje proportionally */
  .card-root.personaje { width: 104px; height: 72px }
}
