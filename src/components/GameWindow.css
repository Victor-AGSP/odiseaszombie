/* Styles for the in-game window (organized and deduplicated)
  Sections: variables, container, header, body/board, deck, table, hand, team-bar,
  controls, HUD/misc, modals, responsive
*/

/* -----------------------------
  Variables & Base
  ----------------------------- */
:root {
  /* palette */
  --navy-base: #0B3C5D;
  --blood-red: #8A0707;
  --dark-gray: #2E2E2E;
  --soft-white: #FAFAFA;
  --pure-black: #0A0A0A;
}

/* -----------------------------
  Container / Window
  ----------------------------- */
.gw-root {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, rgba(4,6,8,0.62), rgba(2,3,4,0.72));
  z-index: 2000;
  padding: 1rem;
}

.gw-window {
  position: relative;
  width: 100%;
  max-width: 1100px;
  height: 80vh;
  background: linear-gradient(180deg, rgba(11,60,93,0.98) 0%, rgba(10,44,72,0.95) 40%, rgba(12,18,22,0.85) 100%);
  border-radius: 12px;
  border: 1px solid rgba(138,7,7,0.04);
  /* lighter shadow to reduce repaint cost */
  box-shadow: 0 10px 28px rgba(6,10,14,0.48), inset 0 1px 0 rgba(255,255,255,0.02);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  padding-bottom: 120px;
}

/* -----------------------------
  Header
  ----------------------------- */
.gw-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(90deg, rgba(11,60,93,0.12), rgba(138,7,7,0.04));
}
.gw-title { color: var(--soft-white); font-weight: 700 }
.gw-close { background: transparent; border: none; color: var(--soft-white); font-size: 1.1rem; cursor: pointer; padding: 0.25rem 0.5rem }

/* -----------------------------
  Body / Board layout
  ----------------------------- */
.gw-body {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding: 1rem;
  flex: 1 1 auto;
  color: var(--soft-white);
}

.gw-board { display: flex; gap: 1rem; padding: 0.8rem 1rem; flex: 1 1 auto; align-items: stretch }
.gw-opponent, .gw-player { width: 22%; display:flex; flex-direction:column; gap:0.6rem }
.gw-center { flex:1; display:flex; gap:1rem; align-items:flex-start }
.table-column { flex: 1 1 auto; display:flex; flex-direction:column; gap:0.6rem; min-width: 0; min-height: 0 }
.side-column, .left-column { display: none }

/* -----------------------------
  Deck area
  ----------------------------- */
.deck-area { display:flex; flex-direction:column; align-items:center; gap:0.6rem }
.deck-stack { position:relative }
.deck-card {
  width:72px; height:96px; border-radius:8px;
  display:flex; align-items:center; justify-content:center; font-size:1.6rem;
  /* reduced shadow for performance */
  box-shadow:0 8px 18px rgba(6,10,14,0.45);
  position:relative;
  background: linear-gradient(180deg, rgba(11,60,93,0.95), rgba(10,30,48,0.95));
  border: 1px solid rgba(255,255,255,0.03);
}
.deck-card::before{ content:''; position:absolute; inset:6px; border-radius:6px; background:linear-gradient(180deg, rgba(6,32,42,0.9), rgba(4,16,24,0.9)); opacity:0.9 }
.deck-count { position:absolute; right:-8px; bottom:-10px; background:linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.9)); color: var(--soft-white); padding:4px 8px; border-radius:10px; font-weight:800; box-shadow: 0 4px 10px rgba(138,7,7,0.12) }
.deck-stack::before,.deck-stack::after{ content:''; position:absolute; left:6px; top:6px; width:72px; height:96px; border-radius:8px; background: linear-gradient(180deg, rgba(11,60,93,0.9), rgba(6,18,26,0.9)); box-shadow:0 8px 22px rgba(2,6,12,0.45); transform:translate3d(-6px,6px,0); opacity:0.85 }
.deck-stack::before{ box-shadow:0 6px 12px rgba(2,6,12,0.32) }
.deck-stack::after{ transform:translate3d(-10px,10px,0); opacity:0.7; box-shadow:0 4px 10px rgba(2,6,12,0.28) }
.draw-btn { padding: 0.45rem 0.7rem; border-radius:8px; background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.94)); color: var(--soft-white); border:none; cursor:pointer; font-weight:800; letter-spacing:0.2px }
.discard { opacity:0.8; font-size:0.9rem }
.draw-btn[disabled], .draw-btn:disabled { opacity: 0.5; cursor: not-allowed; /* avoid filter: grayscale which triggers repaint */ }
.deck-hud { display:flex; gap:0.6rem; align-items:center }
.deck-hud .deck-stack { width:72px }
.deck-hud .deck-controls { display:flex; flex-direction:column; gap:6px; align-items:flex-start }
.deck-extra-controls { display:flex; gap:8px; flex-direction:column; align-items:center; justify-content:center; margin-left: 6px }
.deck-extra-btn { padding: 0.4rem 0.7rem; border-radius:8px; background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.94)); color: var(--soft-white); border:none; cursor:pointer; font-weight:700; transition: transform 120ms cubic-bezier(.2,.9,.3,1) }
.deck-extra-btn:active { transform: translateY(1px) }

/* -----------------------------
  Table (cards on board)
  ----------------------------- */
.table-area { background: linear-gradient(180deg, rgba(11,60,93,0.06), rgba(0,0,0,0.06)); border-radius:10px; padding:1.5rem 1.5rem 1rem 1.5rem; min-height:160px; display:flex; align-items:center; justify-content:center; border: 1px solid rgba(255,255,255,0.03) }
.table-placeholder { color: rgba(250,250,250,0.85) }
.table-cards { position:relative; display:flex; align-items:flex-start; justify-content:flex-start; gap:1.2rem; flex-wrap:wrap }
.table-slot { width: 104px; height: 140px; display:inline-block; position:relative; will-change:transform; margin:10px }
.table-slot { perspective: 300px; -webkit-perspective: 300px }
.table-slot .card-root { transform-origin: center center; width:104px; height:140px }
.table-pan { overflow: hidden; width: 100%; display:flex; flex-direction:column; justify-content:flex-start; align-items:stretch; cursor: grab; flex: 1 1 auto; min-height: 0 }
.table-pan.grabbing { cursor: grabbing }
.table-pan-inner { will-change: transform; transition: transform 120ms linear; min-height: 0; flex: 1 1 auto; display:flex; align-items:flex-start }
.table-cards { padding: 14px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.04); background: linear-gradient(180deg, rgba(10,14,18,0.02), rgba(8,10,12,0.06)); /* lighter shadows */ box-shadow: inset 0 1px 4px rgba(138,7,7,0.02), 0 6px 18px rgba(6,10,14,0.36); max-height: 360px; overflow: auto }
.table-pan.grabbing .table-pan-inner { transition: none !important }

/* -----------------------------
  Hand area
  ----------------------------- */
.hand-label { color: rgba(255,255,255,0.85); font-weight:700; margin-left:0.4rem }
.hand-area { display:flex; gap:0.6rem; align-items:flex-end; padding:0.5rem 0 }
.hand-slot { display:inline-block; transition: transform 220ms cubic-bezier(.2,.9,.2,1), box-shadow 220ms ease; will-change: transform; transform-origin: center bottom; transform-style: preserve-3d }
.hand-slot + .hand-slot { margin-left: -56px }
.hand-slot .card-root { transform-origin: center center; backface-visibility: hidden }
.hand-slot:hover { z-index: 9999 }

/* -----------------------------
  Team bar
  ----------------------------- */
.team-bar {
  position: absolute; left: 50%; bottom: 12px; transform: translateX(-50%);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 0.75rem 1rem; border-radius: 12px;
  background: linear-gradient(180deg, rgba(11,60,93,0.12), rgba(138,7,7,0.06));
  border: 1px solid rgba(138,7,7,0.08); box-shadow: 0 18px 50px rgba(6,10,14,0.66), inset 0 1px 0 rgba(255,255,255,0.02);
  width: min(96%, 1100px); z-index: 2400; pointer-events: auto;
  min-height: 150px;
}
.team-sections { display:flex; gap:12px; align-items:center; width:100% }
.team-equipo { flex: 1 1 auto; display:flex; flex-direction:column; align-items:flex-start; justify-content:center; min-width: 0 }
.team-side-slots { display:flex; flex-direction:row; gap:20px; align-items:center; justify-content:flex-end; flex: 0 0 auto; margin-left: 12px; z-index: 2450 }
.team-slot { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border-radius:8px; padding:10px; display:flex; flex-direction:column; align-items:center; min-height: 120px; min-width: 132px; border: 1px solid rgba(255,255,255,0.03) }
.slot-body { display:flex; align-items:center; justify-content:center; width:100%; height:100% }
.empty-slot { color: rgba(255,255,255,0.28); font-size:20px }
.team-equipo .hand-area { padding: 6px 0; width: 100%; box-sizing: border-box }
.team-bar .hand-area { display:flex; gap:0.6rem; align-items:flex-end; padding:0.25rem 6px; pointer-events: auto; overflow-x: auto; overflow-y: hidden; width: 100%; -webkit-overflow-scrolling: touch }
.team-bar .hand-area::-webkit-scrollbar { height: 10px }
.team-bar .hand-area::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.06); border-radius: 8px }
.team-bar .hand-area .hand-slot { flex: 0 0 auto }
.team-bar .hand-slot + .hand-slot { margin-left: -36px }
.team-bar .hand-area { cursor: grab }
.team-bar .hand-area.dragging { cursor: grabbing }

/* -----------------------------
  Floating controls & other buttons
  ----------------------------- */
.floating-controls { position: absolute; right: 12px; top: 56px; z-index: 2200; display:flex; gap:0.5rem; padding:0.5rem; background: linear-gradient(180deg, rgba(10,14,16,0.7), rgba(6,8,10,0.5)); border-radius:8px; border:1px solid rgba(255,255,255,0.03) }
.floating-controls button { padding:0.45rem 0.6rem; border-radius:6px; border:none; background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.92)); color: var(--soft-white); cursor:pointer; font-weight:700 }
.gw-controls { display:flex; gap:0.5rem; margin-top:0.6rem }
.gw-controls button { padding:0.5rem 0.7rem; border-radius:8px; border:none; background: linear-gradient(180deg, rgba(11,60,93,0.98), rgba(10,30,48,0.92)); color: var(--soft-white); cursor:pointer; font-weight:700 }

/* Button interaction animations (applies to buttons inside the game window) */
.gw-window button,
.floating-controls button,
.deck-extra-btn,
.draw-btn,
.gw-controls button,
.recruit-die,
.card-menu button {
  /* avoid filter transitions to reduce repaints; animate transform & box-shadow only */
  transition: transform 160ms cubic-bezier(.2,.9,.3,1), box-shadow 160ms cubic-bezier(.2,.9,.3,1);
  will-change: transform, opacity, box-shadow;
}
.gw-window button:hover,
.floating-controls button:hover,
.deck-extra-btn:hover,
.draw-btn:hover,
.gw-controls button:hover,
.recruit-die:hover,
.card-menu button:hover {
  transform: translateY(-4px) scale(1.01);
  /* avoid filter (brightness) here to prevent extra paint cost */
  box-shadow: 0 6px 18px rgba(2,6,14,0.22);
}
.gw-window button:active,
.floating-controls button:active,
.deck-extra-btn:active,
.draw-btn:active,
.gw-controls button:active,
.recruit-die:active,
.card-menu button:active {
  transform: translateY(0px) scale(0.985);
  box-shadow: 0 4px 10px rgba(2,6,14,0.14);
}

/* -----------------------------
  Logs, HUD, misc
  ----------------------------- */
.gw-log { margin-left: 1rem; color: rgba(250,250,250,0.9) }
.gw-log h4 { margin: 0 0 0.4rem 0; font-size:0.95rem }
.gw-log ul { margin:0; padding:0; list-style:none }
.gw-log li { background: rgba(255,255,255,0.02); margin-bottom:6px; padding:6px 8px; border-radius:6px }
.gw-footer { padding: 0.6rem 1rem; text-align: right; font-size: 0.85rem; color: rgba(255,255,255,0.6); border-top: 1px solid rgba(255,255,255,0.02) }
.gw-overlay-stats { position: absolute; left: 1.5rem; top: 1.5rem; display: flex; flex-direction: row; gap: 0.8rem; align-items: center; z-index: 2100 }
.gw-overlay-stats .stats-box { background: rgba(0,0,0,0.45); border: 1px solid rgba(255,255,255,0.04); padding: 0.45rem 0.6rem; border-radius: 8px; color: #eaf5ff; font-size: 0.85rem; display:flex; flex-direction:column; align-items:center; gap:0.15rem }
.stat-value { font-weight:800; font-size:1.1rem }
.player-events { margin-top: 0.6rem }
.events-label { font-size:0.85rem; color:#dbeff0; margin-bottom:0.4rem }
.events-list { display:flex; gap:0.4rem }
.event-pill { background: rgba(255,255,255,0.04); padding:6px 8px; border-radius:6px; color:#eef6f7 }
.card-menu { position: fixed; z-index: 99999; background: linear-gradient(180deg, rgba(10,14,16,0.98), rgba(6,8,10,0.98)); border: 1px solid rgba(255,255,255,0.04); padding: 8px; border-radius: 8px; box-shadow: 0 6px 18px rgba(0,0,0,0.45); min-width: 160px; transform-origin: center bottom; transform: translate(-50%, -110%) }

/* -----------------------------
  Card preview & modals
  ----------------------------- */
.card-modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 99950; opacity: 0; pointer-events: none; transition: opacity 240ms ease }
.card-modal-backdrop.fast-show { transition-duration: 40ms !important }
.card-modal-backdrop.fast-show .card-modal-content { transition-duration: 40ms !important }
.card-modal-backdrop.show { opacity: 1; pointer-events: auto }
.card-modal-content { transform: scale(0.92); transition: transform 240ms cubic-bezier(.2,.9,.2,1), opacity 240ms ease; opacity: 0; will-change: transform, opacity }
.card-modal-backdrop.show .card-modal-content { transform: scale(1); opacity: 1 }
.card-modal-content .card-root { transform-origin: center center; transform: none; box-shadow: 0 30px 80px rgba(0,0,0,0.7) }
.card-modal-content .card-root { width: 220px !important; height: 310px !important }
.card-modal-content .card-risk { font-size: 4rem !important }
.card-modal-content .card-conflict { font-size: 1.6rem !important }

.recruit-die { background: linear-gradient(180deg, rgba(11,60,93,0.95), rgba(6,12,16,0.95)); color: var(--soft-white); border: 1px solid rgba(255,255,255,0.06); padding: 8px 14px; border-radius: 8px; font-size: 1.25rem; cursor: pointer; box-shadow: 0 6px 20px rgba(0,0,0,0.5) }
.recruit-die[disabled] { opacity: 0.7; cursor: default }
.recruit-die.shake-red { animation: shake-red 520ms cubic-bezier(.2,.8,.2,1); border-color: rgba(255,90,90,0.95); box-shadow: 0 6px 20px rgba(255, 90, 90, 0.12), 0 0 0 6px rgba(255,90,90,0.06) }
@keyframes shake-red { 0% { transform: translateX(0) scale(1); } 10% { transform: translateX(-6px) rotate(-3deg) scale(1.02); } 30% { transform: translateX(6px) rotate(3deg) scale(1.02); } 50% { transform: translateX(-4px) rotate(-2deg) scale(1.01); } 70% { transform: translateX(4px) rotate(2deg) scale(1.01); } 100% { transform: translateX(0) rotate(0deg) scale(1); } }

/* preview responsive sizes */
@media (max-width: 520px) { .card-modal-content .card-root { width: 160px !important; height: 240px !important } .card-modal-content { padding: 12px } }

/* -----------------------------
  Responsive (merged)
  ----------------------------- */
@media (max-width: 900px) {
  .gw-board { flex-direction: column }
  .gw-opponent, .gw-player { width: 100% }
  .gw-log { margin-left: 0; margin-top: 0.6rem }
}

@media (max-width: 520px) {
  .gw-root { padding: 0.5rem }
  .gw-window { max-width: 100%; height: calc(100vh - 16px); border-radius: 8px; padding: 0.5rem }
  .gw-body { padding: 0.6rem; gap: 0.5rem; flex-direction: column }
  .gw-board { flex-direction: column; gap: 0.6rem; padding: 0.6rem }
  .gw-opponent, .gw-player { width: 100%; display:flex; flex-direction:row; justify-content:space-between; align-items:center }
  .gw-center { width: 100% }

  /* Hand responsive */
  .hand-area { margin: 0; gap: 0.5rem; justify-content:flex-start; overflow-x: auto; padding-bottom: 6px; -webkit-overflow-scrolling: touch }
  .hand-area > * { margin: 0 8px }
  .hand-slot + .hand-slot { margin-left: -24px }
  @media (max-width: 360px) { .hand-slot + .hand-slot { margin-left: 0 } }

  /* Team bar flows under content and smaller slots */
  .team-bar { position: static; transform: none; left: auto; bottom: auto; width: 100%; margin-top: 8px; border-radius: 8px }
  .team-slot { min-height: 92px; min-width: 92px; padding: 6px }

  /* Floating controls on mobile */
  .floating-controls { position: fixed; right: 12px; top: auto; bottom: 12px; left: auto; z-index: 2500 }
  .floating-controls button { padding: 0.6rem 0.85rem; font-size: 0.95rem }

  /* Deck/card sizes */
  .deck-card { width: 56px; height: 76px; font-size: 1.2rem }
  .table-slot { width: 100px; height: 140px }

  /* HUD compact */
  .gw-overlay-stats { left: 0.8rem; top: auto; bottom: 96px; flex-direction: row; gap: 0.5rem }
  .gw-overlay-stats .stats-box { padding: 0.35rem 0.5rem; font-size: 0.85rem }

  /* Table wrapping */
  .table-cards { justify-content: flex-start; flex-wrap: wrap }

  /* Card menu: ensure it fits on narrow screens */
  .card-menu { left: 50% !important; top: auto !important; bottom: 12px !important; transform: translateX(-50%) !important; width: min(92%, 320px) !important; box-sizing: border-box }
}

