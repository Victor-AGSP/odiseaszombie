/* Styles for the in-game window (organized and deduplicated)
  Sections: variables, container, header, body/board, deck, table, hand, team-bar,
  controls, HUD/misc, modals, responsive
*/

/* -----------------------------
  Variables & Base
  ----------------------------- */
:root {
  /* palette */
  --navy-base: #0B3C5D;
  --blood-red: #8A0707;
  --dark-gray: #2E2E2E;
  --soft-white: #FAFAFA;
  --pure-black: #0A0A0A;
}

/* -----------------------------
  Container / Window
  ----------------------------- */
.gw-root {
  position: fixed;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: linear-gradient(180deg, rgba(4,6,8,0.62), rgba(2,3,4,0.72));
  z-index: 2000;
  padding: 1rem;
}

.gw-window {
  position: relative;
  width: 100%;
  /* aumentar el max-width para dar mÃ¡s espacio horizontal al centro (tablero) */
  max-width: 1400px;
  /* make the game window taller so the board has more vertical room */
  height: 88vh;
  background: linear-gradient(180deg, rgba(11,60,93,0.98) 0%, rgba(10,44,72,0.95) 40%, rgba(12,18,22,0.85) 100%);
  border-radius: 12px;
  border: 1px solid rgba(138,7,7,0.04);
  /* lighter shadow to reduce repaint cost */
  box-shadow: 0 10px 28px rgba(6,10,14,0.48), inset 0 1px 0 rgba(255,255,255,0.02);
  display: flex;
  flex-direction: column;
  overflow: hidden;
  /* Remove bottom padding so the board fills the available height; team-bar is independent */
  padding-bottom: 0;
}

/* -----------------------------
  Header
  ----------------------------- */
.gw-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: 0.75rem 1rem;
  border-bottom: 1px solid rgba(255,255,255,0.03);
  background: linear-gradient(90deg, rgba(11,60,93,0.12), rgba(138,7,7,0.04));
}
.gw-title { color: var(--soft-white); font-weight: 700 }
.gw-close { background: transparent; border: none; color: var(--soft-white); font-size: 1.1rem; cursor: pointer; padding: 0.25rem 0.5rem }

/* -----------------------------
  Body / Board layout
  ----------------------------- */
.gw-body {
  display: flex;
  flex-direction: column;
  gap: 1rem;
  padding: 1rem;
  flex: 1 1 auto;
  color: var(--soft-white);
}

.gw-board { display: flex; gap: 1rem; padding: 0.8rem 1rem; flex: 1 1 auto; align-items: stretch }
.gw-opponent, .gw-player { width: 18%; display:flex; flex-direction:column; gap:0.6rem }
.gw-center { flex:1; display:flex; gap:1rem; align-items:flex-start }
.table-column { flex: 1 1 auto; display:flex; flex-direction:column; gap:0.6rem; min-width: 0; min-height: 0 }
.side-column, .left-column { display: none }

/* -----------------------------
  Deck area
  ----------------------------- */
.deck-area { display:flex; flex-direction:column; align-items:center; gap:0.6rem }
.deck-stack { position:relative; width:60px; height:84px; display:inline-flex; align-items:center; justify-content:center }
.deck-card {
  width:60px; height:84px; border-radius:7px;
  display:flex; align-items:center; justify-content:center; font-size:1.4rem;
  /* reduced shadow for performance */
  box-shadow:0 6px 14px rgba(6,10,14,0.42);
  position:relative;
  z-index:2; /* keep card above the stack pseudo-layers */
  /* use palette vars and a subtle two-tone gradient for depth */
  background: linear-gradient(180deg, var(--navy-base) 0%, rgba(6,18,26,0.95) 100%);
  border: 1px solid rgba(255,255,255,0.03);
  color: var(--soft-white);
  text-shadow: 0 1px 0 rgba(0,0,0,0.6);
}
.deck-count { position:absolute; left:50%; transform:translateX(-50%); bottom:-12px; right:auto; background:linear-gradient(180deg, var(--blood-red), rgba(110,6,6,0.9)); color: var(--soft-white); padding:4px 8px; border-radius:10px; font-weight:800; box-shadow: 0 4px 10px rgba(138,7,7,0.12); z-index:3 }
.table-cards {
  position: relative;
  display: grid;
  grid-auto-flow: row;
  /* Keep exactly 5 columns per row. Each column will be at least the card's
     min width but may grow to fill available space evenly. Cards are centered
     inside each column so their intrinsic width is preserved while the grid
     expands vertically as more rows are added. */
  grid-template-columns: repeat(5, minmax(120px, 1fr));
  gap: 20px 30px; /* row-gap 20px, column-gap 30px */
  padding: 16px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(12,20,24,0.02), rgba(10,14,18,0.04));
  box-shadow: inset 0 1px 4px rgba(255,255,255,0.02), 0 6px 18px rgba(6,10,14,0.36);
  align-items: start;
  box-sizing: border-box;
  /* Use full available width so the grid distributes 5 columns across the area.
     Center cards within their cell and prevent horizontal scrolling; when more
     cards are added the grid will create new rows and increase in height. */
  width: 100%;
  max-width: 100%;
  justify-content: center;
  justify-items: center;
}
.deck-stack::before{ transform: translate3d(-6px,6px,0); z-index:0; box-shadow:0 5px 10px rgba(2,6,12,0.32) }
.deck-stack::after{ transform: translate3d(-10px,10px,0); opacity:0.7; z-index:-1; box-shadow:0 3px 8px rgba(2,6,12,0.28) }
.deck-stack:hover .deck-card { transform: translateY(-3px); box-shadow: 0 10px 28px rgba(2,6,14,0.34); transition: transform 180ms ease, box-shadow 180ms ease }
.draw-btn { padding: 0.45rem 0.7rem; border-radius:8px; background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.94)); color: var(--soft-white); border:none; cursor:pointer; font-weight:800; letter-spacing:0.2px }
.discard { opacity:0.8; font-size:0.9rem }
.draw-btn[disabled], .draw-btn:disabled { opacity: 0.5; cursor: not-allowed; /* avoid filter: grayscale which triggers repaint */ }
.deck-hud { display:flex; gap:0.6rem; align-items:center }
.deck-hud .deck-stack { width:60px }
.deck-hud .deck-controls { display:flex; flex-direction:column; gap:6px; align-items:flex-start }
.deck-extra-controls { display:flex; gap:8px; flex-direction:column; align-items:center; justify-content:center; margin-left: 6px }
.deck-extra-btn { padding: 0.4rem 0.7rem; border-radius:8px; background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.94)); color: var(--soft-white); border:none; cursor:pointer; font-weight:700; transition: transform 120ms cubic-bezier(.2,.9,.3,1) }
.deck-extra-btn:active { transform: translateY(1px) }

/* Disabled state: darker, less saturated, not clickable */
.deck-extra-btn:disabled,
.deck-extra-btn[disabled] {
  background: linear-gradient(180deg, rgba(60,20,20,0.95), rgba(40,12,12,0.95));
  opacity: 0.65;
  cursor: not-allowed;
  color: rgba(240,240,240,0.85);
  box-shadow: none;
  transform: none;
}

.deck-discard-btn { padding: 0.35rem 0.6rem; border-radius:8px; background: linear-gradient(180deg, rgba(6,18,26,0.9), rgba(8,28,40,0.9)); color: var(--soft-white); border:none; cursor:pointer; font-weight:700; font-size:0.85rem }
.deck-discard-btn:hover { transform: translateY(-3px); box-shadow: 0 8px 22px rgba(2,6,14,0.28) }

/* -----------------------------
  Table (cards on board)
  ----------------------------- */
.table-area {
  background: linear-gradient(180deg, rgba(11,60,93,0.06), rgba(0,0,0,0.06));
  border-radius: 10px;
  /* adjusted padding so table has enough room but isn't overly large */
  padding: 3rem 2.5rem 2rem 2.5rem;
  /* adequate min height to ensure cards fit without escaping */
  min-height: 360px;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid rgba(255,255,255,0.03);
  box-sizing: border-box; /* ensure padding is included in width calculations */
  /* Prefer vertical expansion: prevent horizontal scrolling and allow the
     table-area to grow vertically when new rows are created. */
  overflow-x: hidden;
  overflow-y: auto;
}
.table-placeholder { color: rgba(250,250,250,0.85) }
.table-cards {
  position: relative;
  display: grid;
  grid-auto-flow: row;
  grid-template-columns: repeat(5, minmax(120px, 1fr));
  gap: 20px 30px;
  padding: 20px;
  margin: 0 32px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.04);
  background: linear-gradient(180deg, rgba(12,20,24,0.02), rgba(10,14,18,0.04));
  box-shadow: inset 0 1px 4px rgba(255,255,255,0.02), 0 6px 18px rgba(6,10,14,0.36);
  align-items: start;
  box-sizing: border-box;
  width: 100%;
  max-width: 100%;
  justify-content: center;
  justify-items: center;
}

/* When there are no cards, collapse the grid visually so it starts at 0 and
   grows naturally when children are added. This keeps the layout symmetric
   and avoids relying on JS to toggle classes. Note: :empty matches only when
   there are no element children (no text nodes). */
.table-cards:empty {
  /* hide grid when there are no card children without collapsing layout width
     so the surrounding .table-area keeps its spacing. */
  display: none;
}
/* Make slots auto-size to their content so landscape (personaje) cards don't overflow
   or overlap neighbouring slots. We center the card inside each slot and allow the
   inner .card-root to determine the actual size. */
.table-slot {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  position: relative;
  will-change: transform;
  /* remove external margin so spacing is controlled by the grid gap only */
  margin: 0;
  padding: 14px; /* reduced gutter so cards sit a bit closer */
  perspective: 300px;
  -webkit-perspective: 300px;
}
.table-slot .card-root { transform-origin: center center; /* allow card-root to determine its own size */ }
/* Visual indicator for characters awaiting decision: red outline */
.table-slot.awaiting-decision {
  /* ensure slot is positioned so the pseudo-element can overlay the transformed card */
  position: relative;
}
.table-slot.awaiting-decision .card-root {
  /* keep a subtle inner halo on the card itself */
  box-shadow: 0 6px 18px rgba(2,6,12,0.28), inset 0 0 0 1px rgba(255,80,80,0.06);
  border-radius: 8px;
  position: relative; /* establish stacking context so pseudo-element can sit above */
  z-index: 1;
}

/* Strong visible halo drawn from the slot (not the transformed card) so it remains visible
   even when the card uses perspective/3D transforms. The pseudo-element is placed above
   the card and uses a soft red glow and a ring to make the conflict state obvious. */
.table-slot.awaiting-decision::after {
  /* remove slot-level halo so the red border can be drawn with the card's own
     pseudo-element and therefore follow the card's 3D perspective. Keep this
     pseudo-element present but transparent to avoid layout shifts. */
  content: '';
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 2;
  background: transparent;
}

/* Overlay with conflict button shown when a card is selected during decision */
.decision-overlay {
  position: absolute;
  bottom: 8px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 8px;
  z-index: 4000;
}

/* When the player attempts to advance while conflicts remain, briefly highlight
   awaiting cards with an opaque but non-glaring border to draw attention. The
   .conflict-alert class is toggled on the .gw-window container from JS. */
.gw-window.conflict-alert .table-slot.awaiting-decision .card-inner::after {
  border-color: rgba(255,90,90,0.95);
  box-shadow: 0 10px 30px rgba(255,80,80,0.18), 0 0 36px rgba(255,60,60,0.08);
  transform: translateZ(3px) scale(1.02);
  transition: transform 220ms ease, box-shadow 220ms ease, border-color 220ms ease;
  animation: conflict-alert-fade 700ms ease-in-out;
}

@keyframes conflict-alert-fade {
  0% { transform: translateZ(3px) scale(1.00); box-shadow: 0 6px 18px rgba(255,80,80,0.12); }
  40% { transform: translateZ(3px) scale(1.06); box-shadow: 0 18px 46px rgba(255,70,70,0.20); }
  100% { transform: translateZ(3px) scale(1.00); box-shadow: 0 8px 22px rgba(255,70,70,0.14); }
}

/* Initiative chooser slider: appears to the right of the preview modal on larger screens,
   or below on small screens. Use transform for smooth entrance. */
.initiative-slider {
  position: absolute;
  top: 0;
  left: calc(100% + 12px);
  width: 360px;
  max-width: 42vw;
  height: 100%;
  background: linear-gradient(180deg, rgba(8,12,16,0.98), rgba(12,16,20,0.95));
  border: 1px solid rgba(255,255,255,0.04);
  border-radius: 10px;
  box-shadow: 0 20px 60px rgba(0,0,0,0.6);
  padding: 6px;
  overflow: auto;
  transform: translateX(8px) scale(0.99);
  opacity: 0;
  transition: transform 220ms ease, opacity 220ms ease;
  z-index: 99999;
}
.initiative-slider.open { transform: translateX(0) scale(1); opacity: 1 }

/* Make the initiative option cards much smaller inside the chooser popup so they
   appear as compact thumbnails. Use !important sparingly to override Card.css
   sizing rules that apply to modal previews. */
.initiative-slider .initiative-option {
  padding: 16px 18px;
  border-radius: 8px;
  min-width: 300px; /* increased to be much larger per request */
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 16px;
}
.initiative-slider .initiative-option > div { width: 300px !important; }
.initiative-slider .initiative-option .card-root { width: 300px !important; height: auto !important; max-height: 460px !important; }
.initiative-slider .initiative-option .card-inner { height: auto !important; }
.initiative-slider .initiative-option .card-art-img { width: 100% !important; height: auto !important; object-fit: cover !important; }

/* Match button sizing if any remain; buttons will be removed by JSX but keep safe styles */
.initiative-slider .initiative-option .deck-extra-btn { padding: 12px 14px; font-size: 1.05rem }

@media (max-width: 780px) {
  .initiative-slider .initiative-option { min-width: 240px }
  .initiative-slider .initiative-option > div { width: 240px !important }
  .initiative-slider .initiative-option .card-root { width: 240px !important; max-height: 360px !important }
}

@media (max-width: 780px) {
  .initiative-slider { position: static; width: 100%; max-width: 100%; left: auto; top: auto; transform: none; opacity: 1; margin-top: 10px; }
}

/* Smooth movement for options when hovering: base override for initiative-option */
.initiative-slider .initiative-option { transition: transform 220ms cubic-bezier(.2,.9,.3,1), box-shadow 220ms ease }
.initiative-slider .initiative-option:hover { z-index: 30; }

/* Apply a vivid red outline on the card's own pseudo-element so it transforms
   together with the card (perspective/3D). This makes the red border visually
   consistent with the card tilt/rotate. */
.table-slot.awaiting-decision .card-inner::after {
  border: 2px solid rgba(255,80,80,0.95);
  /* keep the outline close to the card surface so it doesn't look lifted */
  box-shadow: 0 6px 16px rgba(255,80,80,0.16), 0 0 20px rgba(255,60,60,0.05);
  transform: translateZ(3px);
}

/* Make the in-card border stronger and add a gentle pulse when the slot/card is selected */
.table-slot.awaiting-decision .card-root .card-inner::after {
  border-width: 3px;
  border-color: rgba(255,60,60,0.98);
  /* reduce vertical offset so the glow appears more even with the card surface */
  box-shadow: 0 8px 22px rgba(255,70,70,0.18), 0 0 28px rgba(255,50,50,0.07);
  transform: translateZ(3px);
}

.table-slot.selected-decision .card-root .card-inner::after,
.table-slot.awaiting-decision.selected-decision .card-root .card-inner::after {
  border-color: rgba(255,40,40,1);
  box-shadow: 0 12px 36px rgba(255,50,50,0.24), 0 0 44px rgba(255,40,40,0.10);
  transform: translateZ(3px);
  animation: conflict-pulse 1400ms ease-in-out infinite;
}

@keyframes conflict-pulse {
  0% { box-shadow: 0 12px 36px rgba(255,60,60,0.20), 0 0 40px rgba(255,50,50,0.10); }
  50% { box-shadow: 0 22px 56px rgba(255,50,50,0.30), 0 0 64px rgba(255,40,40,0.16); }
  100% { box-shadow: 0 12px 36px rgba(255,60,60,0.20), 0 0 40px rgba(255,50,50,0.10); }
}
/* allow Personaje cards to be landscape inside slots - sizing comes from Card.css */
/* no explicit forced size for personaje here; Card.css controls dimensions */
.table-pan { overflow: hidden; width: 100%; display:flex; flex-direction:column; justify-content:flex-start; align-items:stretch; cursor: grab; flex: 1 1 auto; min-height: 0 }
.table-pan.grabbing { cursor: grabbing }
.table-pan-inner { will-change: transform; transition: transform 120ms linear; min-height: 0; flex: 1 1 auto; display:flex; align-items:flex-start; justify-content: center; width: 100% }
/* Table cards should shrink-wrap to their children so the border follows the cards exactly.
  Use inline-flex and remove fixed max-height/overflow so the outline is the tight container. */

.table-pan.grabbing .table-pan-inner { transition: none !important }

/* -----------------------------
  Hand area
  ----------------------------- */
.hand-label { color: rgba(255,255,255,0.85); font-weight:700; margin-left:0.4rem }
.hand-area { display:flex; gap:0.6rem; align-items:flex-end; padding:0.5rem 0 }
.hand-slot { display:inline-block; transition: transform 220ms cubic-bezier(.2,.9,.2,1), box-shadow 220ms ease; will-change: transform; transform-origin: center bottom; transform-style: preserve-3d }
.hand-slot + .hand-slot { margin-left: -44px }
.hand-slot .card-root { transform-origin: center center; backface-visibility: hidden }
.hand-slot:hover { z-index: 9999 }

/* -----------------------------
  Team bar
  ----------------------------- */
.team-bar {
  position: absolute; left: 50%; bottom: 12px; transform: translateX(-50%);
  display: flex; flex-direction: column; align-items: center; justify-content: center;
  padding: 0.75rem 1rem; border-radius: 12px;
  /* make the team-bar background noticeably darker to improve contrast for Equipo/Evento/Talento/Iniciativa
     combine the project's dark-gray with a subtle navy tint for cohesion with the palette */
  background: linear-gradient(180deg, rgba(46,46,46,0.94), rgba(11,60,93,0.10));
  border: 1px solid rgba(0,0,0,0.45);
  box-shadow: 0 12px 30px rgba(0,0,0,0.56), inset 0 1px 0 rgba(255,255,255,0.02);
  width: min(96%, 1100px); z-index: 2400; pointer-events: auto;
  min-height: 150px;
}
.team-sections { display:flex; gap:12px; align-items:center; width:100% }
.team-equipo { flex: 1 1 auto; display:flex; flex-direction:column; align-items:flex-start; justify-content:center; min-width: 0 }
.team-side-slots { display:flex; flex-direction:row; gap:20px; align-items:center; justify-content:flex-end; flex: 0 0 auto; margin-left: 12px; z-index: 2450 }
.team-slot { background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)); border-radius:8px; padding:10px; display:flex; flex-direction:column; align-items:center; min-height: 120px; min-width: 132px; border: 1px solid rgba(255,255,255,0.03) }
.slot-body { display:flex; align-items:center; justify-content:center; width:100%; height:100% }
.empty-slot { color: rgba(255,255,255,0.28); font-size:20px }
.team-equipo .hand-area { padding: 6px 0; width: 100%; box-sizing: border-box }
.team-bar .hand-area { display:flex; gap:0.6rem; align-items:flex-end; padding:0.25rem 6px; pointer-events: auto; overflow-x: auto; overflow-y: hidden; width: 100%; -webkit-overflow-scrolling: touch }
.team-bar .hand-area::-webkit-scrollbar { height: 10px }
.team-bar .hand-area::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.06); border-radius: 8px }
.team-bar .hand-area .hand-slot { flex: 0 0 auto }
.team-bar .hand-slot + .hand-slot { margin-left: -28px }
.team-bar .hand-area { cursor: grab }
.team-bar .hand-area.dragging { cursor: grabbing }

/* -----------------------------
  Floating controls & other buttons
  ----------------------------- */
.floating-controls { position: absolute; right: 12px; top: 56px; z-index: 2200; display:flex; gap:0.5rem; padding:0.5rem; background: linear-gradient(180deg, rgba(10,14,16,0.7), rgba(6,8,10,0.5)); border-radius:8px; border:1px solid rgba(255,255,255,0.03) }
.floating-controls button { padding:0.45rem 0.6rem; border-radius:6px; border:none; background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.92)); color: var(--soft-white); cursor:pointer; font-weight:700 }
.gw-controls { display:flex; gap:0.5rem; margin-top:0.6rem }
.gw-controls button { padding:0.5rem 0.7rem; border-radius:8px; border:none; background: linear-gradient(180deg, rgba(11,60,93,0.98), rgba(10,30,48,0.92)); color: var(--soft-white); cursor:pointer; font-weight:700 }

/* Global surrender button placed on the overlay in the top-right corner */
.surrender-global-btn {
  position: absolute;
  right: 12px;
  top: 12px;
  z-index: 2600;
  padding: 0.45rem 0.75rem;
  border-radius: 8px;
  background: linear-gradient(180deg, rgba(138,7,7,0.98), rgba(110,6,6,0.94));
  color: var(--soft-white);
  border: 1px solid rgba(0,0,0,0.4);
  box-shadow: 0 8px 18px rgba(0,0,0,0.45);
  cursor: pointer;
  font-weight: 800;
  transition: transform 140ms cubic-bezier(.2,.9,.3,1), box-shadow 140ms ease;
}
.surrender-global-btn:hover { transform: translateY(-3px); box-shadow: 0 12px 28px rgba(0,0,0,0.5) }
.surrender-global-btn:active { transform: translateY(0); box-shadow: 0 6px 12px rgba(0,0,0,0.32) }

/* Button interaction animations (applies to buttons inside the game window) */
.gw-window button,
.floating-controls button,
.deck-extra-btn,
.draw-btn,
.gw-controls button,
.recruit-die,
.card-menu button {
  /* avoid filter transitions to reduce repaints; animate transform & box-shadow only */
  transition: transform 160ms cubic-bezier(.2,.9,.3,1), box-shadow 160ms cubic-bezier(.2,.9,.3,1);
  will-change: transform, opacity, box-shadow;
}
.gw-window button:hover,
.floating-controls button:hover,
.deck-extra-btn:hover,
.draw-btn:hover,
.gw-controls button:hover,
.recruit-die:hover,
.card-menu button:hover {
  transform: translateY(-4px) scale(1.01);
  /* avoid filter (brightness) here to prevent extra paint cost */
  box-shadow: 0 6px 18px rgba(2,6,14,0.22);
}
.gw-window button:active,
.floating-controls button:active,
.deck-extra-btn:active,
.draw-btn:active,
.gw-controls button:active,
.recruit-die:active,
.card-menu button:active {
  transform: translateY(0px) scale(0.985);
  box-shadow: 0 4px 10px rgba(2,6,14,0.14);
}

/* -----------------------------
  Logs, HUD, misc
  ----------------------------- */
.gw-log { margin-left: 1rem; color: rgba(250,250,250,0.9) }
.gw-log h4 { margin: 0 0 0.4rem 0; font-size:0.95rem }
.gw-log ul { margin:0; padding:0; list-style:none }
.gw-log li { background: rgba(255,255,255,0.02); margin-bottom:6px; padding:6px 8px; border-radius:6px }
.gw-footer { padding: 0.6rem 1rem; text-align: right; font-size: 0.85rem; color: rgba(255,255,255,0.6); border-top: 1px solid rgba(255,255,255,0.02) }
.gw-overlay-stats { position: absolute; left: 1.9rem; top: 1.1rem; display: flex; flex-direction: row; gap: 0.8rem; align-items: center; z-index: 2100; transition: left 160ms ease, top 160ms ease }
.gw-overlay-stats .stats-box { /* slight blue tint and softer border to match palette */
  background: rgba(11,60,93,0.16); border: 1px solid rgba(255,255,255,0.04); padding: 0.45rem 0.6rem; border-radius: 8px; color: #eaf5ff; font-size: 0.85rem; display:flex; flex-direction:column; align-items:center; gap:0.15rem }
.stat-value { font-weight:800; font-size:1.1rem }
.player-events { margin-top: 0.6rem }
.events-label { font-size:0.85rem; color:#dbeff0; margin-bottom:0.4rem }
.events-list { display:flex; gap:0.4rem }
.event-pill { background: rgba(255,255,255,0.04); padding:6px 8px; border-radius:6px; color:#eef6f7 }
.card-menu { position: fixed; z-index: 99999; background: linear-gradient(180deg, rgba(10,14,16,0.98), rgba(6,8,10,0.98)); border: 1px solid rgba(255,255,255,0.04); padding: 8px; border-radius: 8px; box-shadow: 0 6px 18px rgba(0,0,0,0.45); min-width: 160px; transform-origin: center bottom; transform: translate(-50%, -110%) }

/* -----------------------------
  Card preview & modals
  ----------------------------- */
.card-modal-backdrop { position: fixed; inset: 0; background: rgba(0,0,0,0.6); display: flex; align-items: center; justify-content: center; z-index: 99950; opacity: 0; pointer-events: none; transition: opacity 240ms ease }
.card-modal-backdrop.fast-show { transition-duration: 40ms !important }
.card-modal-backdrop.fast-show .card-modal-content { transition-duration: 40ms !important }
.card-modal-backdrop.show { opacity: 1; pointer-events: auto }
.card-modal-content { transform: scale(0.92); transition: transform 240ms cubic-bezier(.2,.9,.2,1), opacity 240ms ease; opacity: 0; will-change: transform, opacity }
.card-modal-backdrop.show .card-modal-content { transform: scale(1); opacity: 1 }
.card-modal-content .card-root { transform-origin: center center; transform: none; box-shadow: 0 30px 80px rgba(0,0,0,0.7); width: min(360px, 72vw) !important; height: auto !important; max-height: 76vh; }
.card-modal-content .card-root.personaje { width: min(480px, 80vw) !important; height: auto !important; max-height: 76vh }
.card-modal-content .card-risk { font-size: 4rem !important }
.card-modal-content .card-conflict { font-size: 1.6rem !important }

/* Modal: allow inner to size to artwork and keep aspect via contain */
.card-modal-content .card-root .card-inner { height: auto !important; display: block }
.card-modal-content .card-art-img { width: 100% !important; height: auto !important; object-fit: contain; max-height: calc(86vh - 48px); }
/* make front face and image flow normally inside modal (not absolutely positioned) */
.card-modal-content .card-face.card-front { position: relative !important }
.card-modal-content .card-art-img { position: static !important; inset: auto !important; z-index: 1 }

.recruit-die { background: linear-gradient(180deg, rgba(11,60,93,0.95), rgba(6,12,16,0.95)); color: var(--soft-white); border: 1px solid rgba(255,255,255,0.06); padding: 8px 14px; border-radius: 8px; font-size: 1.25rem; cursor: pointer; box-shadow: 0 6px 20px rgba(0,0,0,0.5) }
.recruit-die[disabled] { opacity: 0.7; cursor: default }
.recruit-die.shake-red { animation: shake-red 520ms cubic-bezier(.2,.8,.2,1); border-color: rgba(255,90,90,0.95); box-shadow: 0 6px 20px rgba(255, 90, 90, 0.12), 0 0 0 6px rgba(255,90,90,0.06) }
@keyframes shake-red { 0% { transform: translateX(0) scale(1); } 10% { transform: translateX(-6px) rotate(-3deg) scale(1.02); } 30% { transform: translateX(6px) rotate(3deg) scale(1.02); } 50% { transform: translateX(-4px) rotate(-2deg) scale(1.01); } 70% { transform: translateX(4px) rotate(2deg) scale(1.01); } 100% { transform: translateX(0) rotate(0deg) scale(1); } }

/* preview responsive sizes */
@media (max-width: 520px) { .card-modal-content .card-root { width: 160px !important; height: 240px !important } .card-modal-content { padding: 12px } }

/* -----------------------------
  Responsive (merged)
  ----------------------------- */
@media (max-width: 900px) {
  .gw-board { flex-direction: column }
  .gw-opponent, .gw-player { width: 100% }
  .gw-log { margin-left: 0; margin-top: 0.6rem }
}

@media (max-width: 520px) {
  .gw-root { padding: 0.5rem }
  .gw-window { max-width: 100%; height: calc(100vh - 16px); border-radius: 8px; padding: 0.5rem }
  .gw-body { padding: 0.6rem; gap: 0.5rem; flex-direction: column }
  .gw-board { flex-direction: column; gap: 0.6rem; padding: 0.6rem }
  .gw-opponent, .gw-player { width: 100%; display:flex; flex-direction:row; justify-content:space-between; align-items:center }
  .gw-center { width: 100% }

  /* Hand responsive */
  .hand-area { margin: 0; gap: 0.5rem; justify-content:flex-start; overflow-x: auto; padding-bottom: 6px; -webkit-overflow-scrolling: touch }
  .hand-area > * { margin: 0 8px }
  .hand-slot + .hand-slot { margin-left: -24px }
  @media (max-width: 360px) { .hand-slot + .hand-slot { margin-left: 0 } }

  /* Team bar flows under content and smaller slots */
  .team-bar { position: static; transform: none; left: auto; bottom: auto; width: 100%; margin-top: 8px; border-radius: 8px }
  .team-slot { min-height: 92px; min-width: 92px; padding: 6px }

  /* Floating controls on mobile */
  .floating-controls { position: fixed; right: 12px; top: auto; bottom: 12px; left: auto; z-index: 2500 }
  .floating-controls button { padding: 0.6rem 0.85rem; font-size: 0.95rem }

  /* Deck/card sizes */
  .deck-card { width: 48px; height: 68px; font-size: 1.0rem }
  .table-slot { width: 84px; height: 120px }
  /* mobile: ensure personaje cards scale down to fit horizontally when needed */
  .table-slot .card-root.personaje { width: 120px; height: 84px }

  /* HUD compact */
  .gw-overlay-stats { left: 0.8rem; top: auto; bottom: 96px; flex-direction: row; gap: 0.5rem }
  .gw-overlay-stats .stats-box { padding: 0.35rem 0.5rem; font-size: 0.85rem }

  /* Table wrapping */
  .table-cards { justify-content: flex-start; flex-wrap: wrap }

  /* Card menu: ensure it fits on narrow screens */
  .card-menu { left: 50% !important; top: auto !important; bottom: 12px !important; transform: translateX(-50%) !important; width: min(92%, 320px) !important; box-sizing: border-box }
}

/* Responsive grid adjustments to avoid card overlap on narrower viewports.
   Reduce columns progressively from 5 -> 4 -> 3 -> 2 -> 1 and tweak gaps/margins. */
@media (max-width: 1300px) {
  .table-cards {
    grid-template-columns: repeat(4, minmax(120px, 1fr));
    gap: 18px 22px;
    margin: 0 20px;
  }
  .table-area { padding: 2.4rem 1.8rem 1.4rem 1.8rem }
}

@media (max-width: 1000px) {
  .table-cards {
    grid-template-columns: repeat(3, minmax(100px, 1fr));
    gap: 14px 18px;
    margin: 0 14px;
  }
  .table-area { padding: 2rem 1.2rem 1rem 1.2rem }
}

@media (max-width: 640px) {
  .table-cards {
    grid-template-columns: repeat(2, minmax(84px, 1fr));
    gap: 12px 14px;
    padding: 12px;
    margin: 0 8px;
  }
}

@media (max-width: 380px) {
  .table-cards { grid-template-columns: repeat(1, minmax(72px, 1fr)); gap: 10px }
}

